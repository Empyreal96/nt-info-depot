{\rtf1\ansi {\fonttbl{\f0\fswiss Helv;}{\f1\fmodern Courier New;}} {\colortbl;} \fs20

#{\footnote Summary_Overview}
${\footnote Summary Information}
K{\footnote Summary Information;Stream;IStream Interface;Structured Storage}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
What Is The Summary Information Stream?
\par}\li180
OLE supports the concept of structured storage accessible through the 
 {\i IStream} interface.  Stuctured storage, in turn, supports the concept of
 property sets as a flexible method for serializing almost any information.  The
 OLE specification defines a single standard property set, Summary Information,
 which the Windows 95 Shell uses to populate property sheets viewable from
 the Explorer.  So, information stored in the Summary Information stream can
 be viewed by users when they right mouse click on a Microsoft Installer
 installation database or transform and choose Properties.  The Microsoft
 Installer takes advantage of this fact by storing useful information in the
 Summary Information property set.  This set includes the following properties
 with corresponding Property IDs (PID) and data types:
\line\par\pard
\trowd\trgaph108\trleft540 \cellx2750\cellx5000\cellx5630\cellx7250\cellx10000
\intbl{\b Property Name\cell Property ID\cell PID\cell Type\cell Installer Usage\cell }\row
\intbl{\uldb Codepage}{\v Summary_Codepage}\cell PID_CODEPAGE\cell 1\cell VT_12\cell\row
\intbl{\uldb Title}{\v Summary_Title}\cell PID_TITLE\cell 2\cell VT_LPSTR\cell File Type Description\cell\row
\intbl{\uldb Subject}{\v Summary_Subject}\cell PID_SUBJECT\cell 3\cell VT_LPSTR\cell Product Name\cell\row
\intbl{\uldb Author}{\v Summary_Author}\cell PID_AUTHOR\cell 4\cell VT_LPSTR\cell Vendor\cell\row
\intbl{\uldb Keywords}{\v Summary_Keywords}\cell PID_KEYWORDS\cell 5\cell VT_LPSTR\cell Help for User\cell\row
\intbl{\uldb Comments}{\v Summary_Comments}\cell PID_COMMENTS\cell 6\cell VT_LPSTR\cell Help for User\cell\row
\intbl{\uldb Template}{\v Summary_Template}\cell PID_TEMPLATE\cell 7\cell VT_LPSTR\cell Platform, LangIDs\cell\row
\intbl{\uldb Last Saved By}{\v Summary_SavedBy}\cell PID_LASTAUTHOR\cell 8\cell VT_LPSTR\cell\row
\intbl{\uldb Revision Number}{\v Summary_Revision}\cell PID_REVNUMBER\cell 9\cell VT_LPSTR\cell Product Revision\cell\row
\intbl{\uldb Last Printed}{\v Summary_LastPrinted}\cell PID_LASTPRINTED\cell 11\cell VT_FILETIME\cell\row
\intbl{\uldb Create Time/Date}{\v Summary_Created}\cell PID_CREATE_DTM\cell 12\cell VT_FILETIME\cell Product Release Date\cell\row
\intbl{\uldb Last Save Time/Date}{\v Summary_Saved}\cell PID_LASTSAVE_DTM\cell 13\cell VT_FILETIME\cell Last Database Modification\cell\row
\intbl{\uldb Page Count}{\v Summary_PageCount}\cell PID_PAGECOUNT\cell 14\cell VT_I4\cell Minimum Installer Version\cell\row
\intbl{\uldb Word Count}{\v Summary_SourceType}\cell PID_MSISOURCE\cell 15\cell VT_I4\cell Install Source Type\cell\row
\intbl{\uldb Character Count}{\v Summary_CharCount}\cell PID_CHARCOUNT\cell 16\cell VT_I4\cell Transform Restrictions\cell\row
\intbl{\uldb Creating Application}{\v Summary_Creator}\cell PID_APPNAME\cell 18\cell VT_LPSTR\cell "Microsoft Installer"\cell\row
\intbl{\uldb Security}{\v Summary_Security}\cell PID_SECURITY\cell 19\cell VT_I4\cell Read-only Status\cell\row
\par
The Microsoft Installer currently maintains two storage formats:
 a product specific {\uldb Installation Database}{\v NoHelp}, and a language or
 version specific {\uldb Transform}{\v NoHelp}. The CLSID for the storage is
 set to the appropriate format class for the particular format, independent
 of the Summary Information for the storage.
\par
Values of summary properties for each of the file types are described in the following table (NOT UP TO DATE!):
\line\par\pard
\trowd \trgaph108\trleft540 \cellx2700\cellx4870\cellx7030\cellx9210 
\intbl{\b {\i Summary Property}\cell Configuration Database\cell Installation Database\cell Transform\cell }
\intbl{\uldb {\i Title}}{\v Summary_Title}\cell 
[{\uldb SummaryTitle}{\v Summary_Title}] (e.g., "Configuration Database")\cell 
[{\uldb SummaryTitle}{\v Summary_Title}] (e.g., "Installation Database")\cell 
[{\uldb SummaryTitle}{\v Summary_Title}] (e.g., "Transform")\cell\row
\intbl{\uldb {\i Subject}}{\v Summary_Subject}\cell [{\uldb ProductName}{\v Summary_AppName}]\cell [{\uldb ProductName}{\v Summary_AppName}]\cell [{\uldb ProductName}{\v Summary_AppName}]\cell \row
\intbl{\uldb {\i Author}}{\v Summary_Author}\cell Microsoft Corporation\cell Microsoft Corporation\cell Microsoft Corporation\cell \row
\intbl{\uldb {\i Keywords }}{\v Summary_Keywords}\cell [{\uldb SummaryKeywords}{\v Summary_Keywords}]\cell [{\uldb SummaryKeywords}{\v Summary_Keywords}]\cell [{\uldb SummaryKeywords}{\v Summary_Keywords}]\cell \row
\intbl{\uldb {\i Comments }}{\v Summary_Comments}\cell 
[{\uldb SummaryComments}{\v Summary_Comments}] (e.g.,The Configuration Database contains information about all Microsoft Installer installed products such as PID, location of Installation Database, shared components, etc.)\cell [{\uldb SummaryComments}{\v Summary_Comments}] (e.g., An Installation Database contains the logic and data required to install or modify the installation of a product on a user\rquote s machine.)\cell 
[{\uldb SummaryComments}{\v Summary_Comments}] (e.g., A Transform is a set of changes to be applied to an Installation Database prior to processing the database.  Transforms can be used for creating language version, upgrades, and the like.)\cell\row
\intbl{\uldb {\i Template }}{\v Summary_Template}\cell NULL\cell platform;default language ID;other languageIDs\cell 
base platform;base language ID\cell\row
\intbl{\uldb {\i Last Saved By }}{\v Summary_SavedBy}\cell [{\uldb USERNAME}{\v Property_USERNAME}]\cell NULL\cell new platform;new language ID\cell\row
\intbl{\uldb {\i Revision Number }}{\v Summary_Revision}\cell NULL\cell Product code and version\cell 
Base product code and version;New product code and version\cell\row
\intbl{\uldb {\i Last Printed}}{\v Summary_LastPrinted}\cell NULL\cell Install time\cell NULL\cell\row
\intbl{\uldb {\i Create Time/Date }}{\v Summary_Created}\cell Time & date the Configuration Database was created on a user\rquote s machine.\cell 
Time & date stamped here at Microsoft before shipment\cell Time & date stamped here at Microsoft before shipment\cell\row
\intbl{\uldb {\i Last Saved Time/Date }}{\v Summary_Saved}\cell Time & date of the last time a modification was made.\cell NULL\cell NULL\cell\row 
\intbl{\uldb {\i Number of Pages}}{\v Summary_PageCount}\cell MSI version\cell MSI version\cell MSI version\cell\row
\intbl{\uldb {\i Source Type}}{\v Summary_SourceType}\cell NULL\cell Type code\cell NULL\cell\row
\intbl{\uldb {\i Number of Characters}}{\v Summary_CharCount}\cell NULL\cell NULL\cell transform restrictions\cell\row
\intbl{\i\uldb Creating Application }{\v\f2 Summary_Creator}\cell "Microsoft Installer"\cell "Microsoft Installer"\cell "Microsoft Installer"\cell\row
\intbl{\i\uldb Security}{\v Summary_Security}\cell 0 (none)\cell 2 (read-only recomm.)\cell 4 (read-only enforced)\cell\row
\par 
\page

#{\footnote Summary_AppName}
${\footnote AppName Summary Property}
K{\footnote AppName Summary Property}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
AppName Summary Property
\par}\li180
\page

#{\footnote Summary_Codepage}
${\footnote Codepage Summary Property}
K{\footnote Codepage Summary Property}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Codepage Summary Property
\par}\li180
The Codepage Summary Property identifies the codepage used to display the Summary Information.
 This property never changes.
\page

#{\footnote Summary_Title}
${\footnote Title Summary Property}
K{\footnote Title Summary Property}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Title Summary Property
\par}\li180
The Title Summary Property is used to convey what the *.MSI file is, so the
 value for this summary property is either "Installation Database",
 "Transform", or "Configuration Database", and it never changes.
\page

#{\footnote Summary_Subject}
${\footnote Subject Summary Property}
K{\footnote Subject}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Subject Summary Property
\par}\li180
This summary property is used to convey to a file browser the product that can be installed
 using the logic and data in this installation database.  For example, the
 value of the summary property for Office 97 would be; "Microsoft Office 97
 Professional". This value is typically set from the installer property {\uldb ProductName}{\v Property_ProductName}.
\page

#{\footnote Summary_Author}
${\footnote Author Summary Property}
K{\footnote Author}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Author Summary Property
\par}\li180
The Author Summary Property is used to convey to a file browser who initially created an installation
 database. This value is typically set from the installer property {\uldb Manufacturer}{\v Property_Manufacturer}.
\page

#{\footnote Summary_Keywords}
${\footnote Keywords Summary Property}
K{\footnote Keywords}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Keywords Summary Property
\par}\li180
This summary property is for use by file browsers to hold kewords that
 can permit the database file to be found in a keyword search. The set
 of keywords typically will include "Installer" as well as product-specific keywords,
 and may be localized..
\page

#{\footnote Summary_Comments}
${\footnote Comments Summary Property}
K{\footnote Comments}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Comments Summary Property
\par}\li180
The Comments Summary Property is used to convey the general purpose of the
 installation database.  By default the value for this summary property is set
 to the following:
\par
\tab "This installation database contains the logic and data\line
\tab required to install <{\i product name}>."
\par
where <{\i product name}> is the name of the product being installed (e.g.,
 "Microsoft Office 97 Professional").  In general the value for this summary
 property only changes in the product name, nothing else.  But for localization
 reasons and to allow the modification of this summary property, the Microsoft
\page

#{\footnote Summary_Template}
${\footnote Template Summary Property}
K{\footnote Template}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Template Summary Property
\par}\li180
The Template Summary Property is somewhat overloaded.  Since there is no
 notion of a template in the Microsoft Installer this summary property could
 be left blank.  However, a location is required for the platform and 
 language version(s) supported by an installation database.  The Template 
 summary property is used for this purpose.  In all database types this
 property has the same form.  The value is a list of the platform supported by
 this database (e.g., "Intel"), and the
 language ID (e.g. "1033" for US English) of all languages that are
 supported by this database.  The list is delimited by semi-colons.  For example,
 a database for the Intel platform that supports U.S. English, Farsi, and 
 Byelorussian would have this property set to:
\par
\tab"Intel;1033;1065;1059"
\par
There are variations of this property depending on whether it is in a source 
 installation database, maintenance database, transform, or configuration 
 database.\par
{\b Source Installation Database}\line
In a source installation database any number of languages may be
 specified.  If more than one language is specified then a multi-language
 install will be done.  Listing only one language specifies a single-langage
 install.\par
{\b Maintenance Database}\line
In a maintenance database only one language will be specified.  This is the
 language of the installed product.\par
{\b Transform}\line
In a transform file only one language may be specified.  The specified
 platform and language are used, in combination with the transform
 restrictions, to determine whether a this transform can be applied to a 
 particular database.  Either or both of these properties may be left blank
 if no transform restriction relies on them to validate the transform.\par
{\b Configuration Database}\line
This property is NULL in a configuration database.
\page

#{\footnote Summary_SavedBy}
${\footnote Last Saved By Summary Property}
K{\footnote Last Saved By}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Last Saved By Summary Property
\par}\li180
In an installation database the Last Saved By Summary Property is used to
 keep track of who made the last changes to the database. Initially the value
 for this summary property is set to NULL. However, should a user choose to
 make modifications to an installation the value for this summary property
 changes.  The value is set to the value of the
 {\uldb USERNAME}{\v Property_USERNAME} property defined by the Microsoft
 Installer.\par
{\b Transform}\line
In a transform this property is used for a different purpose. It contains
 the platform and language ID(s) that a database should have after it has
 been transformed. In other words, it specifies what the Template property
 should be set to in the new database. See the description of the 
 {\uldb Template}{\v Summary_Template} property for information about the form of
 this property.\par
{\b Configuration Database}\line
This property is NULL in a configuration database.
\page

#{\footnote Summary_Revision}
${\footnote Revision Number Summary Property}
K{\footnote Revision Number}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Revision Number Summary Property
\par}\li180
The Revision Number Summary Property contains the product ID and version.
 The product ID is a GUID code representing a
 product. The version is stored in a string with the format
 "Maj.Min.Inc.Build". For example, Word 6.0 Build 3280 could be stored as:
\par
\tab "\{000C1101-0000-0000-C000-000000000046\}7.0.0.3280"
\par
{\b Transform}\line
In a transform the product ID and version of both the original and transformed
 database are stored. They are separated with a semi-colon. For example, a
 transform that transforms a database from Office Pro 7.0 to
 Office Standard 7.0 could have this property set to:
\par
\tab "\{000C1101-0000-0000-C000-000000000046\}7.0.0.0;\{000C1101-0000-0000-C000-000000000047\}7.0.0.0"
\par
{\b Configuration Database}\line
This property is NULL is a configuration database.
 \page

#{\footnote Summary_LastPrinted}
${\footnote Last Printed Summary Property}
K{\footnote Last Printed}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Last Printed Property
\par}\li180
The Last Printed property is used to convey when the installation occurred
 (i.e. when the maintenance database was created). Thus, it is NULL in all
 databases except the maintenance database.
\page

#{\footnote Summary_Created}
${\footnote Create Time/Date Summary Property}
K{\footnote Create Time/Date}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Create Time/Date Summary Property
\par}\li180
The Create Time/Date Summary Property is used to convey when the installation
 database was created.  This property is set at Microsoft as part of the
 authoring process and never changes.
\page

#{\footnote Summary_Saved}
${\footnote Last Saved Time/Date Summary Property}
K{\footnote Last Saved Time/Date}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Last Saved Time/Date Summary Property
\par}\li180
The Last Saved Time/Date Summary Property is used to convey when the last time
 the installation database was modified.  Each time a user changes an
 installation the value for this summary property is updated to the current
 system time/date at the time the installation database was saved.  Initially
 the value for this summary property is set to NULL to indicate that no changes
 have yet been made.
\page

#{\footnote Summary_PageCount}
${\footnote Page Count Summary Property}
K{\footnote Page Count Summary Property}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Page Count Summary Property
\par}\li180
The Page Count Summary Property contains the minimum Darwin version reequired.
 It is stored as an integer in the form: Major * 100 + minor.
\page

#{\footnote Summary_CharCount}
${\footnote Character Count Summary Property}
K{\footnote Character Count Summary Property}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Character Count Summary Property
\par}\li180
The Character Count Summary Property is only used in transforms. The upper word
 contains the transform validation flags. The lower word contains the transform
 error condition flags. !! more to be filled in here when implemented
\page

#{\footnote Summary_Creator}
${\footnote Creating Application Summary Property}
K{\footnote Creating Application}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Creating Application Summary Property
\par}\li180
The Creating Application Summary Property is used to convey what
 application created the installation database.  In general the value for
 this summary property is "Microsoft Installer".  However, over time corporate
 customers and/or OEMs may use other tools, via {\uldb OLE Automation}{\v Automate_Info},
 to create installation databases.
\page

#{\footnote Summary_Security}
${\footnote Security Summary Property}
K{\footnote Security;PID_SECURITY}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
Security Summary Property
\par}\li180
The Security Summary Property is used to convey whether the file should be
 opened read-only or read-write. Possible values are:\par
\tab 0\tab No restriction\line
\tab 2\tab Read-only recommended\line
\tab 4\tab Read-only enforced
\page

#{\footnote Summary_SourceType}
${\footnote MSI FileType Summary Property}
K{\footnote Source Imaage Type;PID_MSISOURCE}
\pard\f0\cf1\sb90{\li-150\fi150\brdrb\fs24\b
MSI Source Type Summary Property
\par}\li180
The MSI Source Type Summary Property is used to indicate the type
 of source file image. If this property is not present, it defaults to 0.
 The location of the image is determined by the {\f1 SOURCEFILE} property,
 which defaults to the location of the launcher. Note that this property is
 stored in place of the standard {\bWord Count} property.
\line\tab {\f1 0}\tab Tree image matching the Directory table, long file names.
\line\tab {\f1 1}\tab Tree image matching the Directory table, short file names.
\line\tab {\f1 2}\tab Cabinet and files matching the Media table, long file names.
\line\tab {\f1 3}\tab Cabinet and files matching the Media table, short file names.
\page

}

